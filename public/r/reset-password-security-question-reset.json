{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "reset-password-security-question-reset",
  "type": "registry:block",
  "registryDependencies": [
    "https://ui.woilasoft.com/r/alert.json",
    "https://ui.woilasoft.com/r/badge.json",
    "https://ui.woilasoft.com/r/button.json",
    "https://ui.woilasoft.com/r/card.json",
    "https://ui.woilasoft.com/r/form.json",
    "https://ui.woilasoft.com/r/input.json",
    "https://ui.woilasoft.com/r/select.json"
  ],
  "files": [
    {
      "path": "registry/default/blocks/reset-password-security-question-reset.tsx",
      "content": "\"use client\";\r\r\n\r\r\nimport * as React from \"react\";\r\r\nimport Link from \"next/link\";\r\r\nimport { z } from \"zod\";\r\r\nimport { useForm } from \"react-hook-form\";\r\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\r\nimport {\r\r\n  ArrowRightIcon,\r\r\n  CheckCircleIcon,\r\r\n  EyeIcon,\r\r\n  EyeOffIcon,\r\r\n  KeyIcon,\r\r\n  LockIcon,\r\r\n  ShieldIcon,\r\r\n  UserIcon,\r\r\n} from \"lucide-react\";\r\r\nimport { Button } from \"@/registry/default/ui/button\";\r\r\nimport {\r\r\n  Card,\r\r\n  CardContent,\r\r\n  CardDescription,\r\r\n  CardFooter,\r\r\n  CardHeader,\r\r\n  CardTitle,\r\r\n} from \"@/registry/default/ui/card\";\r\r\nimport {\r\r\n  Form,\r\r\n  FormControl,\r\r\n  FormDescription,\r\r\n  FormField,\r\r\n  FormItem,\r\r\n  FormLabel,\r\r\n  FormMessage,\r\r\n} from \"@/registry/default/ui/form\";\r\r\nimport { Input } from \"@/registry/default/ui/input\";\r\r\nimport { Alert, AlertDescription } from \"@/registry/default/ui/alert\";\r\r\nimport {\r\r\n  Select,\r\r\n  SelectContent,\r\r\n  SelectItem,\r\r\n  SelectTrigger,\r\r\n  SelectValue,\r\r\n} from \"@/registry/default/ui/select\";\r\r\nimport { Badge } from \"@/registry/default/ui/badge\";\r\r\n\r\r\n// Email form schema\r\r\nconst emailSchema = z.object({\r\r\n  email: z.string().email({ message: \"Please enter a valid email address\" }),\r\r\n  username: z\r\r\n    .string()\r\r\n    .min(3, { message: \"Username must be at least 3 characters\" }),\r\r\n});\r\r\n\r\r\n// Security question form schema\r\r\nconst securitySchema = z.object({\r\r\n  question: z.string().min(1, { message: \"Please select a security question\" }),\r\r\n  answer: z\r\r\n    .string()\r\r\n    .min(2, { message: \"Answer must be at least 2 characters\" }),\r\r\n});\r\r\n\r\r\n// Password form schema\r\r\nconst passwordSchema = z\r\r\n  .object({\r\r\n    password: z\r\r\n      .string()\r\r\n      .min(8, { message: \"Password must be at least 8 characters\" })\r\r\n      .regex(/[A-Z]/, {\r\r\n        message: \"Password must contain at least one uppercase letter\",\r\r\n      })\r\r\n      .regex(/[a-z]/, {\r\r\n        message: \"Password must contain at least one lowercase letter\",\r\r\n      })\r\r\n      .regex(/[0-9]/, { message: \"Password must contain at least one number\" }),\r\r\n    confirmPassword: z.string(),\r\r\n  })\r\r\n  .refine((data) => data.password === data.confirmPassword, {\r\r\n    message: \"Passwords do not match\",\r\r\n    path: [\"confirmPassword\"],\r\r\n  });\r\r\n\r\r\ntype EmailFormValues = z.infer<typeof emailSchema>;\r\r\ntype SecurityFormValues = z.infer<typeof securitySchema>;\r\r\ntype PasswordFormValues = z.infer<typeof passwordSchema>;\r\r\n\r\r\nexport default function SecurityQuestionReset() {\r\r\n  const [currentStep, setCurrentStep] = React.useState<\r\r\n    \"identify\" | \"verify\" | \"reset\" | \"success\"\r\r\n  >(\"identify\");\r\r\n  const [userName, setUserName] = React.useState(\"\");\r\r\n  const [isPasswordVisible, setIsPasswordVisible] = React.useState(false);\r\r\n  const [isConfirmPasswordVisible, setIsConfirmPasswordVisible] =\r\r\n    React.useState(false);\r\r\n\r\r\n  // Identity form\r\r\n  const identityForm = useForm<EmailFormValues>({\r\r\n    resolver: zodResolver(emailSchema),\r\r\n    defaultValues: {\r\r\n      email: \"\",\r\r\n      username: \"\",\r\r\n    },\r\r\n  });\r\r\n\r\r\n  // Security question form\r\r\n  const securityForm = useForm<SecurityFormValues>({\r\r\n    resolver: zodResolver(securitySchema),\r\r\n    defaultValues: {\r\r\n      question: \"\",\r\r\n      answer: \"\",\r\r\n    },\r\r\n  });\r\r\n\r\r\n  // Password form\r\r\n  const passwordForm = useForm<PasswordFormValues>({\r\r\n    resolver: zodResolver(passwordSchema),\r\r\n    defaultValues: {\r\r\n      password: \"\",\r\r\n      confirmPassword: \"\",\r\r\n    },\r\r\n  });\r\r\n\r\r\n  function onSubmitIdentity(data: EmailFormValues) {\r\r\n    console.log(\"Identity submitted:\", data);\r\r\n    setUserName(data.username);\r\r\n    setCurrentStep(\"verify\");\r\r\n  }\r\r\n\r\r\n  function onSubmitSecurity(data: SecurityFormValues) {\r\r\n    console.log(\"Security answer submitted:\", data);\r\r\n    setCurrentStep(\"reset\");\r\r\n  }\r\r\n\r\r\n  function onSubmitPassword(data: PasswordFormValues) {\r\r\n    console.log(\"Password submitted:\", data);\r\r\n    setCurrentStep(\"success\");\r\r\n  }\r\r\n\r\r\n  const togglePasswordVisibility = () => {\r\r\n    setIsPasswordVisible(!isPasswordVisible);\r\r\n  };\r\r\n\r\r\n  const toggleConfirmPasswordVisibility = () => {\r\r\n    setIsConfirmPasswordVisible(!isConfirmPasswordVisible);\r\r\n  };\r\r\n\r\r\n  const securityQuestions = [\r\r\n    \"What was the name of your first pet?\",\r\r\n    \"What was your childhood nickname?\",\r\r\n    \"In what city were you born?\",\r\r\n    \"What is your mother's maiden name?\",\r\r\n    \"What high school did you attend?\",\r\r\n    \"What was the make of your first car?\",\r\r\n    \"What is your favorite movie?\",\r\r\n    \"What is the name of your favorite childhood teacher?\",\r\r\n  ];\r\r\n\r\r\n  return (\r\r\n    <div className=\"container mx-auto px-4 py-8 md:px-6 md:py-12\">\r\r\n      <Card className=\"mx-auto max-w-lg\">\r\r\n        {/* Header section with title and description */}\r\r\n        <CardHeader className=\"text-center\">\r\r\n          <div className=\"bg-muted/50 mx-auto flex h-12 w-12 items-center justify-center rounded-full border\">\r\r\n            {currentStep === \"identify\" && <UserIcon className=\"h-6 w-6\" />}\r\r\n            {currentStep === \"verify\" && <ShieldIcon className=\"h-6 w-6\" />}\r\r\n            {currentStep === \"reset\" && <LockIcon className=\"h-6 w-6\" />}\r\r\n            {currentStep === \"success\" && (\r\r\n              <CheckCircleIcon className=\"h-6 w-6 text-green-600\" />\r\r\n            )}\r\r\n          </div>\r\r\n          <CardTitle className=\"text-2xl\">Reset Your Password</CardTitle>\r\r\n          <CardDescription>\r\r\n            {currentStep === \"identify\" && \"First, let's identify your account\"}\r\r\n            {currentStep === \"verify\" &&\r\r\n              \"Verify your identity with a security question\"}\r\r\n            {currentStep === \"reset\" && \"Create a new secure password\"}\r\r\n            {currentStep === \"success\" &&\r\r\n              \"Your password has been reset successfully\"}\r\r\n          </CardDescription>\r\r\n\r\r\n          {/* Progress bar */}\r\r\n          <div className=\"mt-6 flex w-full items-center gap-2\">\r\r\n            <div\r\r\n              className={`h-2 flex-1 rounded-full ${\r\r\n                currentStep !== \"identify\" ? \"bg-primary\" : \"bg-primary/30\"\r\r\n              }`}\r\r\n            ></div>\r\r\n            <div\r\r\n              className={`h-2 flex-1 rounded-full ${\r\r\n                currentStep === \"verify\" ||\r\r\n                currentStep === \"reset\" ||\r\r\n                currentStep === \"success\"\r\r\n                  ? \"bg-primary\"\r\r\n                  : \"bg-primary/30\"\r\r\n              }`}\r\r\n            ></div>\r\r\n            <div\r\r\n              className={`h-2 flex-1 rounded-full ${\r\r\n                currentStep === \"reset\" || currentStep === \"success\"\r\r\n                  ? \"bg-primary\"\r\r\n                  : \"bg-primary/30\"\r\r\n              }`}\r\r\n            ></div>\r\r\n            <div\r\r\n              className={`h-2 flex-1 rounded-full ${\r\r\n                currentStep === \"success\" ? \"bg-primary\" : \"bg-primary/30\"\r\r\n              }`}\r\r\n            ></div>\r\r\n          </div>\r\r\n        </CardHeader>\r\r\n\r\r\n        <CardContent className=\"space-y-4 px-6 py-4\">\r\r\n          {/* Step 1: Identify account */}\r\r\n          {currentStep === \"identify\" && (\r\r\n            <Form {...identityForm}>\r\r\n              <form\r\r\n                onSubmit={identityForm.handleSubmit(onSubmitIdentity)}\r\r\n                className=\"space-y-4\"\r\r\n              >\r\r\n                <Alert>\r\r\n                  <AlertDescription>\r\r\n                    Please enter your email address and username to locate your\r\r\n                    account.\r\r\n                  </AlertDescription>\r\r\n                </Alert>\r\r\n\r\r\n                <FormField\r\r\n                  control={identityForm.control}\r\r\n                  name=\"email\"\r\r\n                  render={({ field }) => (\r\r\n                    <FormItem>\r\r\n                      <FormLabel>Email Address</FormLabel>\r\r\n                      <FormControl>\r\r\n                        <Input placeholder=\"Enter your email\" {...field} />\r\r\n                      </FormControl>\r\r\n                      <FormMessage />\r\r\n                    </FormItem>\r\r\n                  )}\r\r\n                />\r\r\n\r\r\n                <FormField\r\r\n                  control={identityForm.control}\r\r\n                  name=\"username\"\r\r\n                  render={({ field }) => (\r\r\n                    <FormItem>\r\r\n                      <FormLabel>Username</FormLabel>\r\r\n                      <FormControl>\r\r\n                        <Input placeholder=\"Enter your username\" {...field} />\r\r\n                      </FormControl>\r\r\n                      <FormMessage />\r\r\n                    </FormItem>\r\r\n                  )}\r\r\n                />\r\r\n\r\r\n                <Button type=\"submit\" className=\"w-full\">\r\r\n                  Continue <ArrowRightIcon className=\"ml-2 h-4 w-4\" />\r\r\n                </Button>\r\r\n              </form>\r\r\n            </Form>\r\r\n          )}\r\r\n\r\r\n          {/* Step 2: Security question verification */}\r\r\n          {currentStep === \"verify\" && (\r\r\n            <Form {...securityForm}>\r\r\n              <form\r\r\n                onSubmit={securityForm.handleSubmit(onSubmitSecurity)}\r\r\n                className=\"space-y-4\"\r\r\n              >\r\r\n                <div className=\"bg-muted rounded-lg p-3\">\r\r\n                  <h3 className=\"mb-1 text-sm font-medium\">Account Found</h3>\r\r\n                  <div className=\"flex items-center gap-2\">\r\r\n                    <UserIcon className=\"h-4 w-4\" />\r\r\n                    <span className=\"text-sm\">{userName}</span>\r\r\n                    <Badge variant=\"outline\" className=\"ml-auto text-xs\">\r\r\n                      Pending Verification\r\r\n                    </Badge>\r\r\n                  </div>\r\r\n                </div>\r\r\n\r\r\n                <Alert className=\"bg-yellow-50 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300\">\r\r\n                  <AlertDescription>\r\r\n                    Please answer your security question to verify your\r\r\n                    identity.\r\r\n                  </AlertDescription>\r\r\n                </Alert>\r\r\n\r\r\n                <FormField\r\r\n                  control={securityForm.control}\r\r\n                  name=\"question\"\r\r\n                  render={({ field }) => (\r\r\n                    <FormItem>\r\r\n                      <FormLabel>Security Question</FormLabel>\r\r\n                      <Select\r\r\n                        onValueChange={field.onChange}\r\r\n                        defaultValue={field.value}\r\r\n                      >\r\r\n                        <FormControl>\r\r\n                          <SelectTrigger>\r\r\n                            <SelectValue placeholder=\"Select a security question\" />\r\r\n                          </SelectTrigger>\r\r\n                        </FormControl>\r\r\n                        <SelectContent>\r\r\n                          {securityQuestions.map((question) => (\r\r\n                            <SelectItem key={question} value={question}>\r\r\n                              {question}\r\r\n                            </SelectItem>\r\r\n                          ))}\r\r\n                        </SelectContent>\r\r\n                      </Select>\r\r\n                      <FormMessage />\r\r\n                    </FormItem>\r\r\n                  )}\r\r\n                />\r\r\n\r\r\n                <FormField\r\r\n                  control={securityForm.control}\r\r\n                  name=\"answer\"\r\r\n                  render={({ field }) => (\r\r\n                    <FormItem>\r\r\n                      <FormLabel>Your Answer</FormLabel>\r\r\n                      <FormControl>\r\r\n                        <Input placeholder=\"Enter your answer\" {...field} />\r\r\n                      </FormControl>\r\r\n                      <FormDescription>\r\r\n                        Answers are case-sensitive and must match exactly what\r\r\n                        you provided when setting up your account.\r\r\n                      </FormDescription>\r\r\n                      <FormMessage />\r\r\n                    </FormItem>\r\r\n                  )}\r\r\n                />\r\r\n\r\r\n                <Button type=\"submit\" className=\"w-full\">\r\r\n                  Verify Identity\r\r\n                </Button>\r\r\n              </form>\r\r\n            </Form>\r\r\n          )}\r\r\n\r\r\n          {/* Step 3: Create new password */}\r\r\n          {currentStep === \"reset\" && (\r\r\n            <Form {...passwordForm}>\r\r\n              <form\r\r\n                onSubmit={passwordForm.handleSubmit(onSubmitPassword)}\r\r\n                className=\"space-y-4\"\r\r\n              >\r\r\n                <Alert className=\"bg-green-50 text-green-800 dark:bg-green-900 dark:text-green-300\">\r\r\n                  <KeyIcon className=\"h-4 w-4\" />\r\r\n                  <AlertDescription>\r\r\n                    Your identity has been verified. Please create a new\r\r\n                    password for your account.\r\r\n                  </AlertDescription>\r\r\n                </Alert>\r\r\n\r\r\n                <FormField\r\r\n                  control={passwordForm.control}\r\r\n                  name=\"password\"\r\r\n                  render={({ field }) => (\r\r\n                    <FormItem>\r\r\n                      <FormLabel>New Password</FormLabel>\r\r\n                      <div className=\"relative\">\r\r\n                        <FormControl>\r\r\n                          <Input\r\r\n                            placeholder=\"••••••••\"\r\r\n                            type={isPasswordVisible ? \"text\" : \"password\"}\r\r\n                            {...field}\r\r\n                          />\r\r\n                        </FormControl>\r\r\n                        <Button\r\r\n                          type=\"button\"\r\r\n                          variant=\"ghost\"\r\r\n                          size=\"icon\"\r\r\n                          className=\"text-muted-foreground absolute top-0 right-0 h-full px-3 py-2\"\r\r\n                          onClick={togglePasswordVisibility}\r\r\n                        >\r\r\n                          {isPasswordVisible ? (\r\r\n                            <EyeOffIcon className=\"h-4 w-4\" />\r\r\n                          ) : (\r\r\n                            <EyeIcon className=\"h-4 w-4\" />\r\r\n                          )}\r\r\n                          <span className=\"sr-only\">\r\r\n                            Toggle password visibility\r\r\n                          </span>\r\r\n                        </Button>\r\r\n                      </div>\r\r\n                      <FormDescription>\r\r\n                        Password must be at least 8 characters with uppercase,\r\r\n                        lowercase, and number.\r\r\n                      </FormDescription>\r\r\n                      <FormMessage />\r\r\n                    </FormItem>\r\r\n                  )}\r\r\n                />\r\r\n\r\r\n                <FormField\r\r\n                  control={passwordForm.control}\r\r\n                  name=\"confirmPassword\"\r\r\n                  render={({ field }) => (\r\r\n                    <FormItem>\r\r\n                      <FormLabel>Confirm Password</FormLabel>\r\r\n                      <div className=\"relative\">\r\r\n                        <FormControl>\r\r\n                          <Input\r\r\n                            placeholder=\"••••••••\"\r\r\n                            type={\r\r\n                              isConfirmPasswordVisible ? \"text\" : \"password\"\r\r\n                            }\r\r\n                            {...field}\r\r\n                          />\r\r\n                        </FormControl>\r\r\n                        <Button\r\r\n                          type=\"button\"\r\r\n                          variant=\"ghost\"\r\r\n                          size=\"icon\"\r\r\n                          className=\"text-muted-foreground absolute top-0 right-0 h-full px-3 py-2\"\r\r\n                          onClick={toggleConfirmPasswordVisibility}\r\r\n                        >\r\r\n                          {isConfirmPasswordVisible ? (\r\r\n                            <EyeOffIcon className=\"h-4 w-4\" />\r\r\n                          ) : (\r\r\n                            <EyeIcon className=\"h-4 w-4\" />\r\r\n                          )}\r\r\n                          <span className=\"sr-only\">\r\r\n                            Toggle confirm password visibility\r\r\n                          </span>\r\r\n                        </Button>\r\r\n                      </div>\r\r\n                      <FormMessage />\r\r\n                    </FormItem>\r\r\n                  )}\r\r\n                />\r\r\n\r\r\n                <Button type=\"submit\" className=\"w-full\">\r\r\n                  Reset Password\r\r\n                </Button>\r\r\n              </form>\r\r\n            </Form>\r\r\n          )}\r\r\n\r\r\n          {/* Step 4: Success */}\r\r\n          {currentStep === \"success\" && (\r\r\n            <div className=\"space-y-6 py-4\">\r\r\n              <div className=\"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-green-100\">\r\r\n                <CheckCircleIcon className=\"h-10 w-10 text-green-600\" />\r\r\n              </div>\r\r\n\r\r\n              <div className=\"text-center\">\r\r\n                <h3 className=\"mb-2 text-xl font-medium\">\r\r\n                  Password Reset Complete\r\r\n                </h3>\r\r\n                <p className=\"text-muted-foreground\">\r\r\n                  Your password has been successfully reset. You can now log in\r\r\n                  with your new credentials.\r\r\n                </p>\r\r\n              </div>\r\r\n\r\r\n              <Button asChild className=\"w-full\">\r\r\n                <Link href=\"#\">Sign In</Link>\r\r\n              </Button>\r\r\n\r\r\n              <div className=\"bg-muted rounded-lg p-4\">\r\r\n                <h4 className=\"mb-2 text-sm font-medium\">\r\r\n                  Security Recommendations\r\r\n                </h4>\r\r\n                <ul className=\"text-muted-foreground space-y-1 text-sm\">\r\r\n                  <li className=\"flex items-center gap-2\">\r\r\n                    <div className=\"bg-primary h-1.5 w-1.5 rounded-full\"></div>\r\r\n                    <span>Use a different password for each account</span>\r\r\n                  </li>\r\r\n                  <li className=\"flex items-center gap-2\">\r\r\n                    <div className=\"bg-primary h-1.5 w-1.5 rounded-full\"></div>\r\r\n                    <span>\r\r\n                      Enable two-factor authentication where available\r\r\n                    </span>\r\r\n                  </li>\r\r\n                  <li className=\"flex items-center gap-2\">\r\r\n                    <div className=\"bg-primary h-1.5 w-1.5 rounded-full\"></div>\r\r\n                    <span>Consider using a password manager</span>\r\r\n                  </li>\r\r\n                </ul>\r\r\n              </div>\r\r\n            </div>\r\r\n          )}\r\r\n        </CardContent>\r\r\n\r\r\n        <CardFooter className=\"flex flex-col justify-center border-t px-6 py-4\">\r\r\n          {currentStep !== \"success\" && (\r\r\n            <div className=\"flex w-full flex-col items-center gap-2\">\r\r\n              <p className=\"text-muted-foreground text-sm\">\r\r\n                Remember your password?{\" \"}\r\r\n                <Link href=\"#\" className=\"text-primary font-medium\">\r\r\n                  Sign in instead\r\r\n                </Link>\r\r\n              </p>\r\r\n              {currentStep !== \"identify\" && (\r\r\n                <Button\r\r\n                  variant=\"ghost\"\r\r\n                  size=\"sm\"\r\r\n                  className=\"h-auto p-0 text-xs\"\r\r\n                  onClick={() => setCurrentStep(\"identify\")}\r\r\n                >\r\r\n                  Start over\r\r\n                </Button>\r\r\n              )}\r\r\n            </div>\r\r\n          )}\r\r\n        </CardFooter>\r\r\n      </Card>\r\r\n    </div>\r\r\n  );\r\r\n}\r\r\n",
      "type": "registry:block"
    }
  ],
  "meta": {
    "tags": [
      "reset-password"
    ]
  }
}